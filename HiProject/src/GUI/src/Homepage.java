/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package GUI.src;

import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;
import java.time.LocalDate;
import java.util.*;

import Backend.*;
import Exceptions.UserDoesntExistException;

import java.lang.reflect.Array;

import javax.swing.*;

/**
 * @author joaod
 */
public class Homepage extends javax.swing.JFrame {
    private static User connectedUser;
    private Map<Integer, Project> pl;
    private static ArrayList<String> titles = new ArrayList<>();
    private ArrayList<String> projectsmta(ArrayList<String> ptitles) {
        ptitles.clear();
        ptitles.add("< Please Select a Project >");
        for (Map.Entry<Integer, Project> e : pl.entrySet()) {
            ptitles.add(e.getValue().getTitle());
        }
        return ptitles;
    }

    /**
     * Creates new form Homepage
     */
    public Homepage(User connectedUser) {
        Homepage.connectedUser = connectedUser;
        pl = connectedUser.getProjects().getProjects();
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        projectListComboBox = new javax.swing.JComboBox<>();
        openProjectButton = new javax.swing.JButton();
        selectedProjectNameLabel = new javax.swing.JLabel();
        selectedProjectOwnerLabel = new javax.swing.JLabel();
        selectedProjectPeopleInvolvedLabel = new javax.swing.JLabel();
        selectedProjectProjectStateLabel = new javax.swing.JLabel();
        selectedProjectStartDateLabel = new javax.swing.JLabel();
        jSeparator3 = new javax.swing.JSeparator();
        selectedProjectOwnerValue = new javax.swing.JLabel();
        selectedProjectPeopleInvolvedValue = new javax.swing.JLabel();
        selectedProjectEndDateLabel = new javax.swing.JLabel();
        selectedProjectTasksNumberLabel = new javax.swing.JLabel();
        selectedProjectProjectStateValue = new javax.swing.JLabel();
        selectedProjectStartDateValue = new javax.swing.JLabel();
        selectedProjectEndDateValue = new javax.swing.JLabel();
        selectedProjectTasksNumberValue = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        dashboardPanel = new javax.swing.JPanel();
        jSeparator1 = new javax.swing.JSeparator();
        jSeparator2 = new javax.swing.JSeparator();
        lateProjectsLabel = new javax.swing.JLabel();
        ongoingProjectsLabel = new javax.swing.JLabel();
        completedProjectsLabel = new javax.swing.JLabel();
        completedProjectsValueLabel = new javax.swing.JLabel();
        ongoingProjectsValueLabel = new javax.swing.JLabel();
        lateProjectsValueLabel = new javax.swing.JLabel();
        inNeedOfAttentionLabel = new javax.swing.JLabel();
        inoaProject2ValueLabel = new javax.swing.JLabel();
        inoaProject3ValueLabel = new javax.swing.JLabel();
        inoaProject1ValueLabel = new javax.swing.JLabel();
        biggestProjectLabel = new javax.swing.JLabel();
        bpPeopleInvolvedLabel = new javax.swing.JLabel();
        bpPeopleInvolvedValueLabel = new javax.swing.JLabel();
        bpCompletedTasksLabel = new javax.swing.JLabel();
        bpNameValueLabel = new javax.swing.JLabel();
        bpCompletedTasksValueLabel = new javax.swing.JLabel();
        jMenuBar1 = new javax.swing.JMenuBar();
        jMenu1 = new javax.swing.JMenu();
        newProjectMenuItem = new javax.swing.JMenuItem();
        projectsListMenuItem = new javax.swing.JMenuItem();
        userProfileMenuItem = new javax.swing.JMenuItem();
        exitMenuItem = new javax.swing.JMenuItem();
        jMenu2 = new javax.swing.JMenu();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Homepage");

        jPanel1.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 1, true));

        projectListComboBox.setModel(new javax.swing.DefaultComboBoxModel(projectsmta(titles).toArray()));
        projectListComboBox.addItemListener (new ItemListener() {
            @Override
            public void itemStateChanged(ItemEvent e) {
                String ptitle = projectListComboBox.getItemAt(projectListComboBox.getSelectedIndex());
                if (e.getStateChange() == ItemEvent.SELECTED) {
                    for (Map.Entry<Integer, Project> ee : pl.entrySet()) {
                        if (ptitle.equals(ee.getValue().getTitle())) {
                            selectedProjectNameLabel.setText(ee.getValue().getTitle());
                            selectedProjectOwnerValue.setText(ee.getValue().getOwner().getName());
                            selectedProjectPeopleInvolvedValue.setText(Integer.toString(ee.getValue().getContributors().size()));
                            selectedProjectEndDateValue.setText(ee.getValue().getEndDate().toString());
                            selectedProjectStartDateValue.setText( ee.getValue().getBeginDate().toString());
                            selectedProjectProjectStateValue.setText(ee.getValue().getProjectState().toString());
                            selectedProjectTasksNumberValue.setText( Integer.toString(ee.getValue().getLists().size()));
                        }
                    }
                }
            }
        });

        openProjectButton.setText("Open Project");
        openProjectButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                openProjectButtonActionPerformed(evt);
            }
        });

        selectedProjectNameLabel.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        selectedProjectNameLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        selectedProjectNameLabel.setText("Select a Project to View its Details");

        selectedProjectOwnerLabel.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        selectedProjectOwnerLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        selectedProjectOwnerLabel.setText("Owner:");

        selectedProjectPeopleInvolvedLabel.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        selectedProjectPeopleInvolvedLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        selectedProjectPeopleInvolvedLabel.setText("People Involved:");

        selectedProjectProjectStateLabel.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        selectedProjectProjectStateLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        selectedProjectProjectStateLabel.setText("Project State:");

        selectedProjectStartDateLabel.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        selectedProjectStartDateLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        selectedProjectStartDateLabel.setText("Start Date:");

        jSeparator3.setOrientation(javax.swing.SwingConstants.VERTICAL);

        selectedProjectOwnerValue.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        selectedProjectOwnerValue.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);

        selectedProjectPeopleInvolvedValue.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        selectedProjectPeopleInvolvedValue.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);

        selectedProjectEndDateLabel.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        selectedProjectEndDateLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        selectedProjectEndDateLabel.setText("End Date:");

        selectedProjectTasksNumberLabel.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        selectedProjectTasksNumberLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        selectedProjectTasksNumberLabel.setText("Tasks Number:");

        selectedProjectProjectStateValue.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        selectedProjectProjectStateValue.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);

        selectedProjectStartDateValue.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        selectedProjectStartDateValue.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);

        selectedProjectEndDateValue.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        selectedProjectEndDateValue.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);

        selectedProjectTasksNumberValue.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        selectedProjectTasksNumberValue.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);

        jLabel1.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel1.setText("Projects");

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addGap(55, 55, 55)
                                .addComponent(projectListComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, 220, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addGap(119, 119, 119)
                                .addComponent(openProjectButton)))
                        .addGap(55, 55, 55))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                        .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 310, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)))
                .addComponent(jSeparator3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(selectedProjectOwnerLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(selectedProjectPeopleInvolvedLabel, javax.swing.GroupLayout.DEFAULT_SIZE, 310, Short.MAX_VALUE)
                            .addComponent(selectedProjectProjectStateLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(selectedProjectStartDateLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(selectedProjectEndDateLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(selectedProjectTasksNumberLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(selectedProjectStartDateValue, javax.swing.GroupLayout.DEFAULT_SIZE, 331, Short.MAX_VALUE)
                            .addComponent(selectedProjectEndDateValue, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(selectedProjectTasksNumberValue, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(selectedProjectOwnerValue, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(selectedProjectPeopleInvolvedValue, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(selectedProjectProjectStateValue, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addContainerGap())
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(18, 18, 18)
                        .addComponent(selectedProjectNameLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 610, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap(40, Short.MAX_VALUE))))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jSeparator3)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(27, 27, 27)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(projectListComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(28, 28, 28)
                        .addComponent(openProjectButton))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(selectedProjectNameLabel)
                        .addGap(18, 18, 18)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(selectedProjectOwnerLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(selectedProjectOwnerValue, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(selectedProjectPeopleInvolvedLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(selectedProjectPeopleInvolvedValue, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(selectedProjectProjectStateLabel)
                            .addComponent(selectedProjectProjectStateValue, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(selectedProjectStartDateLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(selectedProjectStartDateValue, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(selectedProjectEndDateLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(selectedProjectEndDateValue, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(selectedProjectTasksNumberLabel)
                    .addComponent(selectedProjectTasksNumberValue, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(69, Short.MAX_VALUE))
        );

        dashboardPanel.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 1, true));

        jSeparator1.setOrientation(javax.swing.SwingConstants.VERTICAL);

        jSeparator2.setOrientation(javax.swing.SwingConstants.VERTICAL);

        lateProjectsLabel.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        lateProjectsLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lateProjectsLabel.setText("Late Projects");

        ongoingProjectsLabel.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        ongoingProjectsLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        ongoingProjectsLabel.setText("Ongoing Projects");

        completedProjectsLabel.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        completedProjectsLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        completedProjectsLabel.setText("Completed Projects");

        completedProjectsValueLabel.setFont(new java.awt.Font("Tahoma", 0, 20)); // NOI18N
        completedProjectsValueLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        completedProjectsValueLabel.setText(String.format("%d/%d", Homepage.connectedUser.getProjects().completedProjects(), Homepage.connectedUser.getProjects().getProjects().size()));

        ongoingProjectsValueLabel.setFont(new java.awt.Font("Tahoma", 0, 20)); // NOI18N
        ongoingProjectsValueLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        ongoingProjectsValueLabel.setText(String.format("%d/%d", Homepage.connectedUser.getProjects().ongoingProjects(), Homepage.connectedUser.getProjects().getProjects().size()));

        lateProjectsValueLabel.setFont(new java.awt.Font("Tahoma", 0, 20)); // NOI18N
        lateProjectsValueLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lateProjectsValueLabel.setText(String.format("%d/%d", Homepage.connectedUser.getProjects().lateProjects(), Homepage.connectedUser.getProjects().getProjects().size()));

        inNeedOfAttentionLabel.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        inNeedOfAttentionLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        inNeedOfAttentionLabel.setText("In Need of Attention");

        inoaProject2ValueLabel.setFont(new java.awt.Font("Tahoma", 0, 20)); // NOI18N
        inoaProject2ValueLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        inoaProject2ValueLabel.setText(inoaProjects2GetText(connectedUser.getProjects().biggestProject().completedTasks()));

        inoaProject3ValueLabel.setFont(new java.awt.Font("Tahoma", 0, 20)); // NOI18N
        inoaProject3ValueLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        inoaProject3ValueLabel.setText(inoaProjects3GetText(connectedUser.getProjects().biggestProject().completedTasks()));

        inoaProject1ValueLabel.setFont(new java.awt.Font("Tahoma", 0, 20)); // NOI18N
        inoaProject1ValueLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        inoaProject1ValueLabel.setText(inoaProjects1GetText(connectedUser.getProjects().biggestProject().completedTasks()));

        biggestProjectLabel.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        biggestProjectLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        biggestProjectLabel.setText("Biggest Project");

        bpPeopleInvolvedLabel.setFont(new java.awt.Font("Tahoma", 0, 20)); // NOI18N
        bpPeopleInvolvedLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        bpPeopleInvolvedLabel.setText("People Involved in Project:");

        bpPeopleInvolvedValueLabel.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        bpPeopleInvolvedValueLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        bpPeopleInvolvedValueLabel.setText(String.valueOf(connectedUser.getProjects().biggestProject().getContributors().size()));

        bpCompletedTasksLabel.setFont(new java.awt.Font("Tahoma", 0, 20)); // NOI18N
        bpCompletedTasksLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        bpCompletedTasksLabel.setText("Completed Tasks:");

        bpNameValueLabel.setFont(new java.awt.Font("Tahoma", 2, 24)); // NOI18N
        bpNameValueLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        bpNameValueLabel.setText(connectedUser.getProjects().biggestProject().getTitle());

        bpCompletedTasksValueLabel.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        bpCompletedTasksValueLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        bpCompletedTasksValueLabel.setText(String.valueOf(connectedUser.getProjects().biggestProject().completedTasks().size()));

        javax.swing.GroupLayout dashboardPanelLayout = new javax.swing.GroupLayout(dashboardPanel);
        dashboardPanel.setLayout(dashboardPanelLayout);
        dashboardPanelLayout.setHorizontalGroup(
            dashboardPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(dashboardPanelLayout.createSequentialGroup()
                .addGroup(dashboardPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(ongoingProjectsLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(lateProjectsLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(completedProjectsLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(completedProjectsValueLabel, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 326, Short.MAX_VALUE)
                    .addComponent(ongoingProjectsValueLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(lateProjectsValueLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(dashboardPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(inoaProject1ValueLabel, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 328, Short.MAX_VALUE)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, dashboardPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(inNeedOfAttentionLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 326, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(inoaProject2ValueLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 326, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(inoaProject3ValueLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jSeparator2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(dashboardPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(biggestProjectLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(bpPeopleInvolvedLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(bpPeopleInvolvedValueLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(bpCompletedTasksLabel, javax.swing.GroupLayout.DEFAULT_SIZE, 326, Short.MAX_VALUE)
                    .addComponent(bpNameValueLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(bpCompletedTasksValueLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
        );
        dashboardPanelLayout.setVerticalGroup(
            dashboardPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jSeparator1)
            .addComponent(jSeparator2, javax.swing.GroupLayout.Alignment.TRAILING)
            .addGroup(dashboardPanelLayout.createSequentialGroup()
                .addGap(55, 55, 55)
                .addGroup(dashboardPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(dashboardPanelLayout.createSequentialGroup()
                        .addComponent(completedProjectsLabel)
                        .addGap(18, 18, 18)
                        .addComponent(completedProjectsValueLabel)
                        .addGap(59, 59, 59)
                        .addComponent(ongoingProjectsLabel)
                        .addGap(18, 18, 18)
                        .addComponent(ongoingProjectsValueLabel)
                        .addGap(44, 44, 44)
                        .addComponent(lateProjectsLabel)
                        .addGap(18, 18, 18)
                        .addComponent(lateProjectsValueLabel))
                    .addGroup(dashboardPanelLayout.createSequentialGroup()
                        .addComponent(inNeedOfAttentionLabel)
                        .addGap(45, 45, 45)
                        .addComponent(inoaProject1ValueLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(40, 40, 40)
                        .addComponent(inoaProject2ValueLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(40, 40, 40)
                        .addComponent(inoaProject3ValueLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(dashboardPanelLayout.createSequentialGroup()
                        .addComponent(biggestProjectLabel)
                        .addGap(18, 18, 18)
                        .addComponent(bpNameValueLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(45, 45, 45)
                        .addComponent(bpPeopleInvolvedLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(bpPeopleInvolvedValueLabel)
                        .addGap(35, 35, 35)
                        .addComponent(bpCompletedTasksLabel)
                        .addGap(18, 18, 18)
                        .addComponent(bpCompletedTasksValueLabel)))
                .addContainerGap(44, Short.MAX_VALUE))
        );

        jMenuBar1.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 1, true));

        jMenu1.setText("File");

        newProjectMenuItem.setText("New Project");
        newProjectMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                newProjectMenuItemActionPerformed(evt);
            }
        });
        jMenu1.add(newProjectMenuItem);

        projectsListMenuItem.setText("Projects List");
        projectsListMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                projectsListMenuItemActionPerformed(evt);
            }
        });
        jMenu1.add(projectsListMenuItem);

        userProfileMenuItem.setText("User Profile");
        userProfileMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                userProfileMenuItemActionPerformed(evt);
            }
        });
        jMenu1.add(userProfileMenuItem);

        exitMenuItem.setText("Exit");
        exitMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                exitMenuItemActionPerformed(evt);
            }
        });
        jMenu1.add(exitMenuItem);

        jMenuBar1.add(jMenu1);

        jMenu2.setText("Edit");
        jMenuBar1.add(jMenu2);

        setJMenuBar(jMenuBar1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(dashboardPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(1, 1, 1)
                .addComponent(dashboardPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        setSize(new java.awt.Dimension(1018, 849));
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void projectsListMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_projectsListMenuItemActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_projectsListMenuItemActionPerformed

    private void exitMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_exitMenuItemActionPerformed
        System.exit(1);
    }//GEN-LAST:event_exitMenuItemActionPerformed

    private void userProfileMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_userProfileMenuItemActionPerformed
        ManageUserAccount mua = new ManageUserAccount(connectedUser);
        mua.setVisible(true);
    }//GEN-LAST:event_userProfileMenuItemActionPerformed

    private void newProjectMenuItemActionPerformed(java.awt.event.ActionEvent evt) {
        NewProject newp = new NewProject(connectedUser);
        newp.setModal(true);
        newp.setVisible(true);
        updateHomepage();
    }

    private void openProjectButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_openProjectButtonActionPerformed
        String ptitle = this.projectListComboBox.getItemAt(projectListComboBox.getSelectedIndex());
        for (Map.Entry<Integer, Project> e : pl.entrySet()) {
            if (ptitle.equals(e.getValue().getTitle())) {
                new ProjectPage(e.getValue(), connectedUser).setVisible(true);
                dispose();
            }
        }
    }//GEN-LAST:event_openProjectButtonActionPerformed

    public String inoaProjects1GetText(ArrayList<Task> tasks) {
        try {
            return (tasks.get(0).getTitle());
        } catch (IndexOutOfBoundsException e) {
            e.printStackTrace();
            return ("No projects in need of attention yet.");
        }
    }

    public String inoaProjects2GetText(ArrayList<Task> tasks) {
        try {
            return (tasks.get(1).getTitle());
        } catch (IndexOutOfBoundsException e) {
            e.printStackTrace();
            return ("None.");
        }
    }

    public String inoaProjects3GetText(ArrayList<Task> tasks) {
        try {
            return (tasks.get(2).getTitle());
        } catch (IndexOutOfBoundsException e) {
            e.printStackTrace();
            return ("None.");
        }
    }

    private void updateHomepage() {
        this.dispose();
        HiProject hiProject = new Serialization(String.format("%s\\HiProject.data", System.getProperty("user.dir"))).load();
        try {
            User updatedConnectedUser = hiProject.getUsers().getUser(connectedUser.getEmail());
            new Homepage(updatedConnectedUser).setVisible(true);
        } catch (UserDoesntExistException e) {
            e.printStackTrace();
        }
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(Homepage.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(Homepage.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(Homepage.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(Homepage.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new Homepage(connectedUser).setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel biggestProjectLabel;
    private javax.swing.JLabel bpCompletedTasksLabel;
    private javax.swing.JLabel bpCompletedTasksValueLabel;
    private javax.swing.JLabel bpNameValueLabel;
    private javax.swing.JLabel bpPeopleInvolvedLabel;
    private javax.swing.JLabel bpPeopleInvolvedValueLabel;
    private javax.swing.JLabel completedProjectsLabel;
    private javax.swing.JLabel completedProjectsValueLabel;
    private javax.swing.JPanel dashboardPanel;
    private javax.swing.JMenuItem exitMenuItem;
    private javax.swing.JLabel inNeedOfAttentionLabel;
    private javax.swing.JLabel inoaProject1ValueLabel;
    private javax.swing.JLabel inoaProject2ValueLabel;
    private javax.swing.JLabel inoaProject3ValueLabel;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JMenu jMenu1;
    private javax.swing.JMenu jMenu2;
    private javax.swing.JMenuBar jMenuBar1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JSeparator jSeparator2;
    private javax.swing.JSeparator jSeparator3;
    private javax.swing.JLabel lateProjectsLabel;
    private javax.swing.JLabel lateProjectsValueLabel;
    private javax.swing.JMenuItem newProjectMenuItem;
    private javax.swing.JLabel ongoingProjectsLabel;
    private javax.swing.JLabel ongoingProjectsValueLabel;
    private javax.swing.JButton openProjectButton;
    private javax.swing.JComboBox<String> projectListComboBox;
    private javax.swing.JMenuItem projectsListMenuItem;
    private javax.swing.JLabel selectedProjectEndDateLabel;
    private javax.swing.JLabel selectedProjectEndDateValue;
    private javax.swing.JLabel selectedProjectNameLabel;
    private javax.swing.JLabel selectedProjectOwnerLabel;
    private javax.swing.JLabel selectedProjectOwnerValue;
    private javax.swing.JLabel selectedProjectPeopleInvolvedLabel;
    private javax.swing.JLabel selectedProjectPeopleInvolvedValue;
    private javax.swing.JLabel selectedProjectProjectStateLabel;
    private javax.swing.JLabel selectedProjectProjectStateValue;
    private javax.swing.JLabel selectedProjectStartDateLabel;
    private javax.swing.JLabel selectedProjectStartDateValue;
    private javax.swing.JLabel selectedProjectTasksNumberLabel;
    private javax.swing.JLabel selectedProjectTasksNumberValue;
    private javax.swing.JMenuItem userProfileMenuItem;
    // End of variables declaration//GEN-END:variables
}
